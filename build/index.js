(()=>{"use strict";var e={20:(e,t,a)=>{var r=a(609),n=Symbol.for("react.element"),i=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,a){var r,o={},c=null,u=null;for(r in void 0!==a&&(c=""+a),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:n,type:e,key:c,ref:u,props:o,_owner:s.current}}},609:e=>{e.exports=window.React},848:(e,t,a)=>{e.exports=a(20)}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,a),i.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};a.r(r),a.d(r,{getAvailableFocusAreas:()=>g,getAvailableModels:()=>f,getAvailableTones:()=>S,getError:()=>y,getFocusAreas:()=>m,getLastReview:()=>T,getReviewHistory:()=>A,getSelectedModel:()=>v,getSettings:()=>_,getTargetTone:()=>b,getUnresolvedNotesCount:()=>w,hasError:()=>I,isLoadingSettings:()=>R,isReviewing:()=>p});var n={};a.r(n),a.d(n,{clearError:()=>V,fetchSettings:()=>N,receiveSettings:()=>C,setAvailableFocusAreas:()=>P,setAvailableModels:()=>D,setAvailableTones:()=>B,startReview:()=>F,updateSettings:()=>M});var i=a(609);const s=window.wp.plugins,l=window.wp.editor,o=window.wp.i18n,c=window.wp.primitives;var u=a(848);const d=(0,u.jsx)(c.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,u.jsx)(c.Path,{fillRule:"evenodd",d:"M7.25 16.437a6.5 6.5 0 1 1 9.5 0V16A2.75 2.75 0 0 0 14 13.25h-4A2.75 2.75 0 0 0 7.25 16v.437Zm1.5 1.193a6.47 6.47 0 0 0 3.25.87 6.47 6.47 0 0 0 3.25-.87V16c0-.69-.56-1.25-1.25-1.25h-4c-.69 0-1.25.56-1.25 1.25v1.63ZM4 12a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm10-2a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z",clipRule:"evenodd"})}),E=window.wp.data;function _(e){return e.settings}function f(e){return e.availableModels}function v(e){return e.settings.defaultModel}function g(e){return e.availableFocusAreas}function m(e){return e.settings.defaultFocusAreas}function S(e){return e.availableTones}function b(e){return e.settings.defaultTone}function p(e){return e.isReviewing}function T(e){return e.lastReview}function A(e){return e.reviewHistory}function y(e){return e.error}function R(e){return e.isLoadingSettings}function w(e){return e.lastReview&&e.lastReview.notes?e.lastReview.notes.filter(e=>!e.resolved).length:0}function I(e){return null!==e.error}const h=window.wp.apiFetch;var k=a.n(h);const L={settings:{defaultModel:"claude-sonnet-4",defaultFocusAreas:["content","tone","flow"],defaultTone:"professional"},availableModels:[],availableFocusAreas:[],availableTones:[],isReviewing:!1,lastReview:null,reviewHistory:[],error:null,isLoadingSettings:!1},O={SET_SETTINGS:"SET_SETTINGS",UPDATE_SETTINGS:"UPDATE_SETTINGS",SET_AVAILABLE_MODELS:"SET_AVAILABLE_MODELS",SET_AVAILABLE_FOCUS_AREAS:"SET_AVAILABLE_FOCUS_AREAS",SET_AVAILABLE_TONES:"SET_AVAILABLE_TONES",START_REVIEW:"START_REVIEW",REVIEW_SUCCESS:"REVIEW_SUCCESS",REVIEW_ERROR:"REVIEW_ERROR",ADD_TO_HISTORY:"ADD_TO_HISTORY",CLEAR_ERROR:"CLEAR_ERROR",SET_LOADING_SETTINGS:"SET_LOADING_SETTINGS"};function*N(){yield{type:O.SET_LOADING_SETTINGS,isLoading:!0};try{return yield k()({path:"/ai-feedback/v1/settings",method:"GET"})}catch(e){throw yield{type:O.REVIEW_ERROR,error:new Error(e.message||"Failed to fetch settings")},e}}function C(e){return{type:O.SET_SETTINGS,settings:e}}function*M(e){try{const t=yield k()({path:"/ai-feedback/v1/settings",method:"POST",data:e});return{type:O.SET_SETTINGS,settings:t}}catch(e){throw yield{type:O.REVIEW_ERROR,error:new Error(e.message||"Failed to update settings")},e}}function*F({postId:e,content:t,title:a,model:r,focusAreas:n,targetTone:i}){yield{type:O.START_REVIEW};try{const s=yield k()({path:"/ai-feedback/v1/review",method:"POST",data:{post_id:e,content:t,title:a,model:r,focus_areas:n,target_tone:i}});return{type:O.REVIEW_SUCCESS,review:s}}catch(e){return{type:O.REVIEW_ERROR,error:new Error(e.message||"Review failed")}}}function V(){return{type:O.CLEAR_ERROR}}function D(e){return{type:O.SET_AVAILABLE_MODELS,models:e}}function P(e){return{type:O.SET_AVAILABLE_FOCUS_AREAS,areas:e}}function B(e){return{type:O.SET_AVAILABLE_TONES,tones:e}}const G="ai-feedback/store",U={reducer:function(e=L,t){switch(t.type){case O.SET_SETTINGS:return{...e,settings:{defaultModel:t.settings.default_model,defaultFocusAreas:t.settings.default_focus_areas,defaultTone:t.settings.default_tone},availableModels:t.settings.available_models||[],availableFocusAreas:t.settings.available_focus_areas||[],availableTones:t.settings.available_tones||[],isLoadingSettings:!1};case O.UPDATE_SETTINGS:return{...e,settings:{...e.settings,...t.settings}};case O.SET_AVAILABLE_MODELS:return{...e,availableModels:t.models};case O.SET_AVAILABLE_FOCUS_AREAS:return{...e,availableFocusAreas:t.areas};case O.SET_AVAILABLE_TONES:return{...e,availableTones:t.tones};case O.START_REVIEW:return{...e,isReviewing:!0,error:null};case O.REVIEW_SUCCESS:return{...e,isReviewing:!1,lastReview:t.review,reviewHistory:[t.review,...e.reviewHistory]};case O.REVIEW_ERROR:return{...e,isReviewing:!1,error:t.error};case O.ADD_TO_HISTORY:return{...e,reviewHistory:[t.review,...e.reviewHistory]};case O.CLEAR_ERROR:return{...e,error:null};case O.SET_LOADING_SETTINGS:return{...e,isLoadingSettings:t.isLoading};default:return e}},selectors:r,actions:n,controls:{},resolvers:{*getSettings(){return C(yield N())}}},W=(0,E.createReduxStore)(G,U);(0,E.register)(W);const x=window.wp.components;function j(){const{availableModels:e,selectedModel:t}=(0,E.useSelect)(e=>({availableModels:e(G).getAvailableModels(),selectedModel:e(G).getSelectedModel()}),[]),{updateSettings:a}=(0,E.useDispatch)(G),r=e.reduce((e,t)=>(e[t.provider]||(e[t.provider]=[]),e[t.provider].push(t),e),{}),n=[];return Object.keys(r).forEach(e=>{const t=e.charAt(0).toUpperCase()+e.slice(1);r[e].forEach(e=>{n.push({label:`${t} - ${e.name}`,value:e.id})})}),(0,i.createElement)(x.SelectControl,{label:(0,o.__)("AI Model","ai-feedback"),value:t,options:n,onChange:e=>{a({default_model:e})},help:(0,o.__)("Select the AI model to use for reviews","ai-feedback")})}const H=window.wp.element;function Y(){const{availableFocusAreas:e,focusAreas:t,availableTones:a,targetTone:r}=(0,E.useSelect)(e=>({availableFocusAreas:e(G).getAvailableFocusAreas(),focusAreas:e(G).getFocusAreas(),availableTones:e(G).getAvailableTones(),targetTone:e(G).getTargetTone()}),[]),{updateSettings:n}=(0,E.useDispatch)(G),s=(0,H.useRef)(null);(0,H.useEffect)(()=>(s.current=function(e){let t;const a=function(...a){clearTimeout(t),t=setTimeout(()=>e.apply(this,a),500)};return a.cancel=()=>clearTimeout(t),a}(n),()=>{s.current&&s.current.cancel()}),[n]);const l=(0,H.useCallback)((e,a)=>{const r=a?[...t,e]:t.filter(t=>t!==e);s.current({default_focus_areas:r})},[t]),c=(0,H.useCallback)(e=>{s.current({default_tone:e})},[]);return(0,i.createElement)("div",{className:"ai-feedback-settings"},(0,i.createElement)("fieldset",null,(0,i.createElement)("legend",null,(0,o.__)("Focus Areas","ai-feedback")),(0,i.createElement)("p",{className:"description"},(0,o.__)("Select the areas you want AI to focus on when reviewing your content","ai-feedback")),e.map(e=>(0,i.createElement)(x.CheckboxControl,{key:e.id,label:e.label,help:e.description,checked:t.includes(e.id),onChange:t=>l(e.id,t)}))),(0,i.createElement)(x.SelectControl,{label:(0,o.__)("Target Tone","ai-feedback"),value:r,options:a.map(e=>({label:e.label,value:e.id})),onChange:c,help:(0,o.__)("The desired tone for your content","ai-feedback")}))}function Z(){const{postId:e,postContent:t,postTitle:a,isReviewing:r,selectedModel:n,focusAreas:s,targetTone:c}=(0,E.useSelect)(e=>({postId:e(l.store).getCurrentPostId(),postContent:e(l.store).getEditedPostContent(),postTitle:e(l.store).getEditedPostAttribute("title"),isReviewing:e(G).isReviewing(),selectedModel:e(G).getSelectedModel(),focusAreas:e(G).getFocusAreas(),targetTone:e(G).getTargetTone()}),[]),{startReview:u}=(0,E.useDispatch)(G),d=!e||r;return(0,i.createElement)("div",{className:"ai-feedback-review-button"},(0,i.createElement)(x.Button,{variant:"primary",onClick:async()=>{if(e)try{await u({postId:e,content:t,title:a,model:n,focusAreas:s,targetTone:c})}catch(e){console.error("Review failed:",e)}},disabled:d,isBusy:r},r?(0,o.__)("Reviewingâ€¦","ai-feedback"):(0,o.__)("Review Document","ai-feedback")),!e&&(0,i.createElement)("p",{className:"description"},(0,o.__)("Save your post first to enable review","ai-feedback")),r&&(0,i.createElement)("p",{className:"description"},(0,o.__)("AI is analyzing your contentâ€¦","ai-feedback")))}function $({review:e}){if(!e||!e.summary)return null;const{summary:t,notes:a,model_used:r}=e;return(0,i.createElement)("div",{className:"ai-feedback-review-summary"},(0,i.createElement)("div",{className:"summary-stats"},(0,i.createElement)("div",{className:"stat"},(0,i.createElement)("strong",null,t.total_notes||0),(0,i.createElement)("span",null,(0,o.__)("Total Feedback Items","ai-feedback")))),t.by_severity&&(0,i.createElement)("div",{className:"summary-by-severity"},(0,i.createElement)("h4",null,(0,o.__)("By Severity","ai-feedback")),(0,i.createElement)("ul",null,t.by_severity.critical>0&&(0,i.createElement)("li",null,"ðŸ”´ ",(0,o.__)("Critical","ai-feedback"),":"," ",t.by_severity.critical),t.by_severity.important>0&&(0,i.createElement)("li",null,"ðŸŸ¡ ",(0,o.__)("Important","ai-feedback"),":"," ",t.by_severity.important),t.by_severity.suggestion>0&&(0,i.createElement)("li",null,"ðŸŸ¢ ",(0,o.__)("Suggestion","ai-feedback"),":"," ",t.by_severity.suggestion))),t.by_category&&(0,i.createElement)("div",{className:"summary-by-category"},(0,i.createElement)("h4",null,(0,o.__)("By Category","ai-feedback")),(0,i.createElement)("ul",null,Object.entries(t.by_category).map(([e,t])=>(0,i.createElement)("li",{key:e},e.charAt(0).toUpperCase()+e.slice(1),": ",t)))),r&&(0,i.createElement)("p",{className:"model-used"},(0,i.createElement)("em",null,(0,o.__)("Reviewed with:","ai-feedback")," ",r)),a&&a.length>0&&(0,i.createElement)("div",{className:"notes-info"},(0,i.createElement)("p",{className:"description"},(0,o.__)("Feedback notes have been attached to your content blocks. Look for the note indicators in the editor.","ai-feedback")),e.note_ids&&e.note_ids.length>0&&(0,i.createElement)("p",{className:"success"},"âœ“ ",(0,o.__)("Created","ai-feedback")," ",e.note_ids.length," ",(0,o.__)("WordPress Notes","ai-feedback")),e.notes_error&&(0,i.createElement)("p",{className:"error"},"âš  ",(0,o.__)("Note creation warning:","ai-feedback")," ",e.notes_error)))}function z(){const{error:e,lastReview:t,isLoadingSettings:a}=(0,E.useSelect)(e=>({error:e(G).getError(),lastReview:e(G).getLastReview(),isLoadingSettings:e(G).isLoadingSettings()}),[]);return a?(0,i.createElement)("div",{className:"ai-feedback-panel"},(0,i.createElement)(x.PanelBody,null,(0,i.createElement)("p",null,(0,o.__)("Loadingâ€¦","ai-feedback")))):(0,i.createElement)("div",{className:"ai-feedback-panel"},e&&(0,i.createElement)(x.Notice,{status:"error",isDismissible:!1},e.message),(0,i.createElement)(x.PanelBody,{title:(0,o.__)("Review Settings","ai-feedback"),initialOpen:!0},(0,i.createElement)(j,null),(0,i.createElement)(Y,null)),(0,i.createElement)(x.PanelBody,{title:(0,o.__)("Review Document","ai-feedback"),initialOpen:!0},(0,i.createElement)(Z,null)),t&&(0,i.createElement)(x.PanelBody,{title:(0,o.__)("Last Review","ai-feedback"),initialOpen:!0},(0,i.createElement)($,{review:t})))}(0,s.registerPlugin)("ai-feedback",{render:()=>(0,i.createElement)(i.Fragment,null,(0,i.createElement)(l.PluginSidebarMoreMenuItem,{target:"ai-feedback-sidebar",icon:d},(0,o.__)("AI Feedback","ai-feedback")),(0,i.createElement)(l.PluginSidebar,{name:"ai-feedback-sidebar",title:(0,o.__)("AI Feedback","ai-feedback"),icon:d},(0,i.createElement)(z,null)))})})();